@filters-icon-font-size: 1.3rem;

//  Common _____________________________________________
& when (@media-common = true) {
	.filter {
		&.block {
			margin-bottom: 0;
		}

		&-title {
			strong {
				.lib-css(background-color, @toolbar-element-background);
				border: 1px solid var(--border-color);
				border-radius: @form-element-input__border-radius;
				font-weight: 400;
				left: 0;
				padding: .9rem @indent__s;
				position: absolute;
				text-align: center;
				top: 0;
				z-index: 2;

				&[data-count]:after {
					.lib-css(color, @color-white);
					background: @theme__color__secondary;
					border-radius: 2px;
					content: attr(data-count);
					display: inline-block;
					font-size: .8em;
					line-height: 1;
					margin: 0 @indent__xs;
					min-width: 1em;
					padding: 2px;
				}

				&.disabled {
					opacity: .5;
				}
			}
		}

		.block-subtitle {
			border-bottom: @border-width__base solid var(--border-color);
			font-size: 1.3rem;
			font-weight: @font-weight__regular;
			line-height: 1em;
			padding: @indent__s @indent__s @indent__base;
		}

		&-subtitle {
			display: none;
		}

		&-current {
			margin: 0;

			.items {
				padding: @indent__xs @indent__s;
			}

			.item {
				position: relative;
				z-index: 1;
			}

			.filter &-subtitle {
				border: none;
				display: block;
				padding-bottom: @indent__s;
			}

			.action.remove {
				&:extend(.abs-remove-button-for-blocks all);
				right: 0;
				position: absolute;
				top: 0;
			}
		}

		&-actions {
			margin-bottom: @indent__m;
			padding: 0 @indent__s;
		}

		&-label {
			font-weight: @font-weight__bold;

			&:after {
				content: ': ';
			}
		}

		&-value {
			.lib-css(color, @filter-quantity);
		}

		&-options {
			display: none;
			margin: 0;

			&-item {
				border-bottom: @border-width__base solid var(--border-color);
				padding-bottom: @indent__s;
			}

			&-title {
				cursor: pointer;
				margin: 0;
				padding: @indent__s @indent__s + 3rem 0 @indent__s;
				position: relative;
				font-size: 1.3rem;

				.lib-icon-font(
					@_icon-font-content: @icon-expand,
					@_icon-font-size: @filters-icon-font-size,
					@_icon-font-position: after,
					@_icon-font-display: block
				);

				&:after {
					position: absolute;
					right: 1.3rem;
					top: 1.2rem;
				}

				&:hover {
					.lib-css(color, @filter-link-hover);
				}

				.active > & {
					.lib-icon-font-symbol(
						@_icon-font-content: @icon-collapse,
						@_icon-font-position: after
					);
				}
			}

			&-content {
				margin: 0;
				padding: @indent__s;

				.item {
					line-height: 1.5rem;
					margin: @indent__s 0;
					text-transform: uppercase;
					font-size: 1.2rem;
				}

				a {
					.lib-css(color, @filter-link);
					margin-left: -.5rem;
					margin-right: -.5rem;
					padding-left: .5rem;
					padding-right: .7rem;
					font-size: 1.2rem;

					&:hover {
						background-color: @color-gray91;
						text-decoration: none;

						& + .count {
							background-color: @color-gray91;
						}
					}
				}

				.count {
					.lib-css(color, @filter-quantity);
					font-weight: @font-weight__light;
					padding-left: .5rem;
					padding-right: .5rem;

					&:before {
						content: '(';
					}

					&:after {
						content: ')';
					}
				}

				.filter-count-label {
					&:extend(.abs-visually-hidden all);
				}
			}
		}

		.swatch-attribute {
			display: block;
			flex-direction: unset;
		}

		.swatch-attribute-options {
			justify-content: unset;
			display: block;
		}
	}
}

//  Mobile _____________________________________________
.media-width(@extremum, @break) when (@extremum = 'max') and (@break = @screen__m) {
	body {
		&.filter-active {
			.page-header {
				display: none;
			}

			.page-wrapper {
				height: 0;
				margin-top: -999999em;
				visibility: hidden;
			}

			.columns {
				z-index: 999;
			}
		}
	}

	.filter {
		&.active {
			position: relative;
			visibility: visible;
			z-index: 99;

			.filter-options-item:last-child {
				margin-bottom: @indent__xl;
			}

			.filter-title {
				border-bottom: 1px solid var(--border-color);
				height: 4.8rem;
				left: 0;
				position: fixed;
				right: 0;
				top: 0;
				z-index: 2;

				strong {
					.lib-css(box-shadow, none);
					background: none;
					border: 0;
					color: transparent;
					left: auto;
					right: 3px;
					top: 10px;
					.lib-icon-font(
							@icon-remove,
						@_icon-font-color: @text__color__muted,
						@_icon-font-size: @icon-font__size,
						@_icon-font-position: after
					);
				}
			}

			.filter-subtitle {
				display: block;
				height: 5rem;
				left: 0;
				line-height: 3.2rem;
				position: fixed;
				right: 0;
				top: 0;
				z-index: 1;
			}

			.filter-options {
				.lib-css(background, @color-white);
				bottom: 0;
				display: block;
				left: 0;
				overflow: scroll;
				position: fixed;
				right: 0;
				top: 5rem;
				z-index: 10;
			}
		}

		& &-subtitle {
			font-size: 2rem;
			font-weight: @font-weight__light;
		}

		&-options-content {
			padding: @indent__xs @indent__s;
		}

		&.filter-current {
			border: solid var(--border-color);
			border-width: 1px 0;
			margin: @indent__xs -@indent__s 0;

			.items {
				display: none;
			}

			&-subtitle {
				position: relative;
				text-transform: uppercase;
				z-index: 1;

				.lib-icon-font(
					@_icon-font-content: @icon-down,
					@_icon-font-size: @icon-font__size,
					@_icon-font-position: before,
					@_icon-font-display: block
				);

				&:before {
					position: absolute;
					right: 1rem;
					top: 1rem;
				}

				&:after {
					.lib-css(color, @text__color__muted);
					content: ' (' attr(data-count) ')';
					font-size: .9em;
				}
			}

			&.active {
				padding-bottom: 3rem;

				.block-subtitle {
					.lib-icon-font-symbol(
						@_icon-font-content: @icon-up,
						@_icon-font-position: before
					);
				}

				.items {
					display: block;
				}

				& + .block-actions {
					display: block;
				}
			}

			& + .block-actions {
				display: none;
			}
		}

		&-options {
			&-content {
				a {
					margin-left: 0;
					margin-right: 0;
					padding-left: .5rem;
					padding-right: .7rem;
					font-size: 1.4rem;
				}
			}
		}

		.ui-slider-horizontal {
			border-radius: 0;
			width: 90% !important;

			.ui-slider-handle {
				margin-left: 0;
				padding-left: 5%;
			}
		}
	}

	.filter-no-options {
		.filter-title {
			&:before {
				background: rgba(255, 255, 255, .5);
				content: '';
				display: block;
				height: 4rem;
				left: 0;
				margin-top: -6rem;
				position: relative;
				width: 7.5rem;
				z-index: 99;
			}
		}

		.filter-content {
			margin-bottom: @indent__base;
		}
	}

	.page-with-filter {
		.columns {
			.sidebar-main {
				.lib-vendor-prefix-order(0);
			}
		}
	}
}

//
//  Desktop
//  _____________________________________________
.media-width(@extremum, @break) when (@extremum = 'min') and (@break = @screen__m) {

	.filter {
		&.block {
			margin-bottom: @indent__xl;
		}

		.block-subtitle {
			padding-left: 0;
		}

		&-title {
			display: none;
		}

		&-content {
			.item {
				margin: @indent__s 0;
			}
		}

		&-actions {
			margin-bottom: @indent__l;
			position: relative;

			.action.filter-clear {
				border: @button-primary__border;
				padding: 0.5rem;
				text-transform: uppercase;
				font-size: 1rem;
				position: absolute;
				right: 0;
				text-decoration: none;
			}
		}

		&.active &-options,
		&-options {
			background: transparent;
			clear: both;
			display: block;
			overflow: initial;
			position: static;

			&-title {
				padding-left: 0;
			}

			&-title {
				&:after {
					right: 0;
				}
			}
		}

		&-subtitle {
			display: block;
			position: static;
		}

		&-current {
			.filter-current-subtitle {
				padding-left: 0;
			}

			.action.remove {
				right: -1rem;
			}
		}
	}

	.page-layout-1column {
		.toolbar-products {
			position: absolute;
			top: 0;
			width: 100%;
		}

		.products ~ .toolbar-products {
			position: static;
		}

		&.page-with-filter .column.main {
			padding-top: 45px;
			position: relative;
			z-index: 1;
		}

		.filter {
			&.block {
				border-top: 1px solid var(--border-color);
			}

			&-content {
				margin-top: @indent__s;
			}

			&-subtitle {
				display: none;
			}

			&-options {
				&-item {
					border: 0;
					display: inline-block;
					margin-right: @indent__m;
					position: relative;

					&.active {
						z-index: 2;

						.filter-options-content {
							visibility: visible;
						}

						&:hover {
							z-index: 3;
						}

						&:after,
						&:before {
							.lib-arrow(up, 8px, @color-black);
							bottom: -1px;
							content: '';
							display: block;
							left: @indent__xs;
							position: absolute;
							z-index: 3;
						}

						&:after {
							.lib-css(border-bottom-color, @color-white);
							margin-top: 2px;
							z-index: 4;
						}
					}
				}

				&-title {
					padding: 0 @indent__base 0 0;

					&:after {
						right: 2px;
						top: 3px;
						z-index: 3;
					}
				}

				&-content {
					@_shadow: 0 3px 5px 0 rgba(50, 50, 50, .75);

					.lib-css(background, @color-white);
					.lib-css(box-shadow, @_shadow, 1);
					border: 1px solid var(--border-color);
					padding: @indent__xs 0;
					position: absolute;
					top: 100%;
					visibility: hidden;
					width: 180px;
					z-index: 2;

					.item {
						margin: 0;
						padding: @indent__xs;

						a {
							margin-left: 0;
						}

						&:hover {
							background-color: @color-gray91;
						}
					}
				}
			}

			&-current {
				display: inline;
				line-height: 3.5rem;

				&-subtitle {
					.lib-css(color, @text__color__muted);
					display: inline;
					font-size: @font-size__base;
					font-weight: normal;
					padding: 0;

					&:after {
						content: ':';
					}
				}

				.item,
				.items {
					display: inline;
				}

				.item {
					margin-right: @indent__m;
					white-space: nowrap;
				}

				.action.remove {
					line-height: normal;
				}
			}

			&-actions {
				display: inline;
				white-space: nowrap;

				& ~ .filter-options {
					margin-top: @indent__m;
				}
			}
		}
	}
}