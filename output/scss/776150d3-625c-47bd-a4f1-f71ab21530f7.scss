$circle-color: #007acc;
$duration: 4s;

[LoadingBar] {
    display: inline-block;
    position: relative;
    width: 50px;
    height: 50px;

    .canvas {
        display: block;
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        transform-origin: 50% 50%;
        animation-iteration-count: infinite;
        animation-duration: $duration;
        animation-name: canvas-frames;
    }

    .circle {
        display: block;
        height: 5px;
        width: 5px;
        margin: 8px;
        border-radius: 50%;
        background-color: $circle-color;
        opacity: 0;
        animation-name: circle-frames;
        animation-iteration-count: infinite;
        animation-duration: $duration;
        animation-timing-function: linear;
    }

    &[stick] {
        width: 100%;
        height: 10px;

        .canvas {
            animation-name: stick-canvas-frames;
        }

        .circle {
            width: 5px;
            height: 5px;
            margin: 2.5px;
        }
    }
}

@keyframes circle-frames {
    0% {
        opacity: 1;
    }

    1% {
        opacity: 1;
    }

    79% {
        opacity: 1;
    }

    80% {
        opacity: 0;
    }
}

$delays: .0s, .167s, .334s, .501s, .668s;

@for $i from 1 through 5 {
    .canvas-#{$i}, .circle-#{$i} {
        animation-delay: #{nth($delays,$i)};
    }
}

$func1: cubic-bezier(0.13, 0.21, 0.1, 0.7);
$func2: cubic-bezier(0.02, 0.33, 0.38, 0.77);
$func3: linear;
$func4: cubic-bezier(0.57, 0.17, 0.95, 0.75);
$func5: cubic-bezier(0, 0.19, 0.07, 0.72);
$func6: linear;
$func7: cubic-bezier(0, 0, 0.95, 0.37);

$timingFuncs: ( "0%": $func1, "10%": $func2, "30%": $func3, "40%": $func4, "50%": $func5, "70%": $func6, "80%": $func7);
$rotations: ( "0%": -110, "10%": 10, "30%": 93, "40%": 205, "50%": 357, "70%": 439, "80%": 585 );

@keyframes canvas-frames {
    @each $name, $rotation in $rotations {
        #{$name} {
            $func: map-get($timingFuncs,$name);

            @if $func {
                animation-timing-function: #{$func};
            }

            transform: rotate(#{$rotation}deg);
        }
    }
}

@keyframes stick-canvas-frames {
    0% {
        animation-timing-function: $func1;
        left: 0;
    }

    50% {
        animation-timing-function: $func7;
        left: 50%;
    }

    80% {
        left: 100%;
    }
}
