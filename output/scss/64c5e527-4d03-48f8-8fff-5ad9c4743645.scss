.app {
	@include media-up(md) {
		display: flex;
	}
}

.switch {
	position: fixed;
	cursor: pointer;
	z-index: 10000;
	overflow: hidden;

	@include media-up(md) {
		width: 100%;
		height: 100vh;

		&>.page {
			position: absolute;
			top: 0;
		}
	}

	@include media-down(sm) {
		left: 0;
		top: calc(100% - 40px);
		width: 100%;
		height: 100%;

		&>.page {
			top: 0;
		}
	}

	transition: transform ease-in-out 350ms;

	header {
		opacity: 0;
		transform: translateY(-100%);
		transition: ease-in-out $fast;
		transition-property: transform, opacity;
		transition-delay: 300ms;
	}

	&>.page {
		opacity: 0;
		transition: opacity ease-in-out 250ms;
	}
}

html {

	&.html--right {

		.page {
			background: $background;
			color: $foreground;
		}

		.switch {
			background: $background-negative;

			.btn--switch {
				background: $background;
				color: $foreground;
			}

			&:hover,
			&.active {
				.btn--switch {
					background: $background-negative;
					color: $foreground-negative;
				}
			}
		}

		@include media-up(md) {
			.page {
				left: 40px;
				width: calc(100% - 40px);
			}

			.switch {
				left: calc(-100% + 40px);

				&>.page {
					left: 0;
					right: -40px;
					width: calc(100% - 40px);
				}

				.btn--switch {
					right: 0;
					border-right: 1px solid $foreground;
					border-left: 1px solid $background;
				}
			}
		}

		&:not(.switching) {
			@include media-up(md) {
				.switch {

					&:hover,
					&.active {
						transform: translateX(0);
					}

					&.long-hover {
						transform: translateX(30%);
					}
				}
			}

			@include media-down(sm) {
				.switch {

					&:hover,
					&.active {
						transform: translateY(-40px);
					}
				}
			}
		}

		&.switching {
			@include media-up(md) {
				.switch {
					transform: translateX(calc(100% - 40px));
				}
			}

			@include media-down(sm) {
				.switch {
					transform: translateY(calc(-100% + 40px));
				}
			}
		}
	}

	&.html--left {

		.page {
			background: $background-negative;
			color: $foreground-negative;
		}

		.switch {
			background: $foreground-negative;

			.btn--switch {
				background: $background-negative;
				color: $foreground-negative;
			}

			&:hover,
			&.active {
				.btn--switch {
					background: $foreground-negative;
					color: $background-negative;
				}
			}
		}

		@include media-up(md) {
			.page {
				left: 0;
				width: calc(100% - 40px);
			}

			.switch {
				right: calc(-100% + 40px);

				&>.page {
					left: 40px;
					right: 0;
					width: calc(100% - 40px);
				}

				.btn--switch {
					left: 0;
					border-left: 1px solid $foreground-negative;
					border-right: 1px solid $background-negative;

					.goto {
						transform: scale(-1, 1);
					}
				}
			}
		}

		&:not(.switching) {
			@include media-up(md) {
				.switch {

					&:hover,
					&.active {
						transform: translateX(0);
					}

					&.long-hover {
						transform: translateX(-30%);
					}
				}
			}

			@include media-down(sm) {
				.switch {

					&:hover,
					&.active {
						transform: translateY(-40px);
					}
				}
			}
		}

		&.switching {
			@include media-up(md) {
				.switch {
					transform: translateX(calc(-100% + 40px));
				}
			}

			@include media-down(sm) {
				.switch {
					transform: translateY(calc(-100% + 40px));
				}
			}
		}
	}

	&:not(.switching) {
		.switch {

			&:hover,
			&.active {
				&>.page {
					opacity: 1;
				}
			}
		}
	}

	&.switching {
		.switch {
			transform: translateX(calc(100% - 40px));

			&>.page {
				opacity: 1;
			}

			header {
				opacity: 1;
				transform: translateY(0);
			}
		}
	}
}

.btn--switch {
	@extend %btn;
	position: absolute;
	top: 0;
	width: 100%;
	height: 100%;
	z-index: 1;

	.incontroluce,
	.davide-groppi,
	&__title {
		position: absolute;
		left: 50%;
		top: 50%;
		fill: currentColor;
	}

	.incontroluce {
		width: 187px * 0.75;
		height: 20px * 0.75;
	}

	.davide-groppi {
		width: 180px * 0.75;
		height: 30px * 0.75;
	}

	&__title {
		font-size: 15px;
		font-weight: $font-light;
		line-height: 1;
		text-transform: uppercase;
		white-space: nowrap;

		b {
			font-weight: $font-regular;
			margin-left: 5px;
		}
	}

	.goto {
		position: absolute;
		fill: currentColor;
	}

	@include media-up(md) {
		width: 40px;

		.incontroluce {
			transform: translateX(-50%) translateY(-50%) rotate(90deg);
		}

		.davide-groppi,
		&__title {
			transform: translateX(-50%) translateY(-50%) rotate(-90deg);
		}

		.goto {
			bottom: 7px;
			left: 7px;
			width: 25px;
			height: 32px;
		}

		&.evidence {
			/*
			&:after {
				content: '';
				display: block;
				position: absolute;
				width: 7px;
				height: 7px;
				border-radius: 50%;
				// animation: bounce-top 1.8s 4 both;
				animation: evidence-top 1.8s 4 both ease-in-out;
				background: #888;
				top: calc(50% - 90px);
				left: calc(50% - 3px);
			}
			*/

			&:before {
				content: '';
				position: absolute;
				top: calc(50vh - 150px + 40px);
				left: 50%;
				width: 8px;
				height: 8px;
				border-radius: 4px;
				margin-left: -4px;
				background: #888888;
				animation: switch-bullet 2s linear infinite;
			}

			&:after {
				content: '';
				position: absolute;
				top: 40px;
				left: 50%;
				width: 1px;
				height: calc(50vh - 150px);
				background: #888888;
				animation: scroll-indicator 2s linear infinite;
			}
		}
	}

	@include media-down(sm) {
		height: 40px;
		border-top: 1px solid $foreground;

		.incontroluce,
		.davide-groppi,
		&__title {
			transform: translateX(-50%) translateY(-50%);
		}

		.goto {
			right: 7px;
			top: 4px;
			width: 25px;
			height: 32px;
			transform: scale(-0.8, 0.8) rotate(90deg);
		}

		&.evidence {
			/*
			&:after {
				content: '';
				display: block;
				position: absolute;
				width: 7px;
				height: 7px;
				border-radius: 50%;
				// animation: bounce-top 1.8s 4 both;
				animation: evidence-top 1.8s 4 both ease-in-out;
				background: #888;
				top: calc(50% - 90px);
				left: calc(50% - 3px);
			}
			*/

			&:before {
				content: '';
				position: absolute;
				left: calc(50vw - 150px + 40px);
				top: 50%;
				width: 8px;
				height: 8px;
				border-radius: 4px;
				margin-top: -4px;
				background: #888888;
				animation: switch-bullet 2s linear infinite;
			}

			&:after {
				content: '';
				position: absolute;
				left: 40px;
				top: 50%;
				height: 1px;
				width: calc(50vw - 150px);
				background: #888888;
				animation: scroll-indicator-horizontal 2s linear infinite;
			}
		}
	}
}

@keyframes switch-bullet {
	0% {
		transform: scale(0, 0);
	}

	30% {
		transform: scale(0, 0);
	}

	50% {
		transform: scale(1, 1);
	}

	70% {
		transform: scale(1, 1);
	}

	71% {
		transform: scale(0, 0);
	}

	100% {
		transform: scale(0, 0);
	}
}

@keyframes evidence-top {
	0% {
		opacity: 0;
		transform: translateY(-200px);
	}

	50% {
		opacity: 1;
		transform: translateY(0px);
	}

	60% {
		opacity: 0;
		transform: translateY(0px) scale(1.5, 1.5);
	}

	100% {
		opacity: 0;
		transform: translateY(0px) scale(1.5, 1.5);
	}
}

@keyframes bounce-top {
	0% {
		animation-timing-function: ease-in;
		opacity: 0;
		transform: translateY(-45px);
	}

	14% {
		opacity: 1;
	}

	20% {
		animation-timing-function: ease-in;
		transform: translateY(-24px);
		opacity: 1;
	}

	32.5% {
		animation-timing-function: ease-in;
		transform: translateY(-12px);
	}

	12.5%,
	27.5%,
	37.5% {
		animation-timing-function: ease-out;
		transform: translateY(0px);
	}

	50% {
		animation-timing-function: ease-out;
		opacity: 1;
		transform: translateY(0px);
	}
}
